(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{var s;t.g.importScripts&&(s=t.g.location+"");var i=t.g.document;if(!s&&i&&(i.currentScript&&(s=i.currentScript.src),!s)){var e=i.getElementsByTagName("script");e.length&&(s=e[e.length-1].src)}if(!s)throw new Error("Automatic publicPath is not supported in this browser");s=s.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=s})(),(()=>{const t=document.getElementById("canvas"),s=t.getContext("2d"),i=(t,i,e)=>{s.beginPath(),s.strokeStyle=e,s.arc(t.x,t.y,i,0,2*Math.PI),s.stroke()},e=(t,i,e)=>{s.drawImage(i,t.x-e.x/2,t.y-e.y/2,e.x,e.y)},r=document.getElementById("sick-text"),o=document.getElementById("level-text"),h=document.getElementById("reset-btn"),a=document.getElementById("speed-bar"),n=document.getElementById("weapon-bar");(new Image).src="./static/img/ethan.png",(new Image).src="./static/img/cough.png";const c=(t,s)=>(t=Math.ceil(t),s=Math.floor(s),Math.floor(Math.random()*(s-t))+t),d=["Obudzcie się ludzie!","Wirusa nie ma!","Zdejmijcie kagańce!","Co z wami nie tak?!","Propaganda!","To wszystko kłamstwo!"];let l=1.3;class u{constructor(t,s){this.x=t,this.y=s}getDistance(t){const s=this.x-t.x,i=this.y-t.y;return Math.sqrt(s*s+i*i)}getAngle(t,s){return Math.atan2(t.y-this.y,t.x-this.x)-Math.atan2(s.y-this.y,s.x-this.x)}moveInDir(t,s){const i=t.x,e=t.y;if(i!=this.x){const t=Math.abs((e-this.y)/(i-this.x));this.x+=Math.sqrt(s/(t*t+1))*(this.x<i?1:-1),this.y+=t*Math.sqrt(s/(t*t+1))*(this.y<e?1:-1)}else this.y+=s*(this.y<e?1:-1)}}class g{constructor(t,s){this.radius=0,this.coords=new u(t,s)}draw(){i(this.coords,this.radius,"#4CAF50"),this.radius+=2}}class m{constructor(t,s){this.velocity=.9,this.radius=20,this.coords=new u(t,s),this.weapon=null}draw(){var t,i;t=this.coords,i=this.radius,s.beginPath(),s.arc(t.x,t.y,i,0,2*Math.PI),s.fillStyle="#000000",s.fill(),s.closePath(),this.weapon&&this.weapon.draw()}live(){}move(s,i){this.coords.getDistance(s)<1||(this.coords.moveInDir(s,this.velocity*i?2:1),this.coords.x+this.radius>t.width?this.coords.x=t.width-this.radius:this.coords.x-this.radius<0&&(this.coords.x=this.radius),this.coords.y+this.radius>t.height?this.coords.y=t.height-this.radius:this.coords.y-this.radius<0&&(this.coords.y=this.radius))}useWeapon(){null===this.weapon&&(this.weapon=new g(this.coords.x,this.coords.y))}}class w{constructor(t,s,i){this.radius=30,this.velocity=1,this.coords=new u(t,s),this.dest=new u(t,s),this.sick=i}draw(){this.sick?e(this.coords,cough,new u(2*this.radius,2*this.radius)):e(this.coords,ethan,new u(2*this.radius,2*this.radius))}makeSick(){return!this.sick&&(this.sick=!0,this.velocity=l,this.lifetime=c(800,1e3),!0)}changeDest(s){if(this.coords.getDistance(this.dest)<3&&(this.dest=new u(c(this.radius,t.width-this.radius),c(this.radius,t.height-this.radius)),this.sick)){let i=this.coords.getAngle(s.coords,this.dest),e=this.coords.getDistance(this.dest);for(;Math.abs(i)<.7&&e>130;)this.dest=new u(c(this.radius,t.width-this.radius),c(this.radius,t.height-this.radius)),i=this.coords.getAngle(s.coords,this.dest)}}move(){this.coords.moveInDir(this.dest,this.velocity)}makeHealthy(){return!!this.sick&&(this.sick=!1,this.radius=30,!0)}getWeapon(t){return!!(this.coords.getDistance(t.coords)<Math.max(this.radius,t.radius)&&this.makeHealthy())}getCough(t){return!!(this.coords.getDistance(t.coords)<Math.max(this.radius,t.radius)&&this.makeSick())}live(t){if(this.sick&&(this.lifetime-=1,this.lifetime<=100)){if(this.lifetime<=0)return this.lifetime=c(800,1e3),this.radius=30,this.velocity=l,!1;this.radius+=.1}return this.changeDest(t),this.move(),!0}}class y{constructor(t,s){this.radius=0,this.coords=new u(t,s),this.text=d[c(0,d.length)]}draw(){var t,e;i(this.coords,this.radius,"#FF0000"),t=this.coords,e=this.text,s.font="15px Arial",s.fillText(e,t.x,t.y),this.radius+=2}}let p,x,f=new u(100,100),k=0,v=0,M=[],b=0,D=0,I=0;h.onclick=()=>{v=0,document.activeElement.blur()},document.onmousemove=s=>{f=((t,s)=>{const i=t.getBoundingClientRect();return new u(s.clientX-i.left,s.clientY-i.top)})(t,s)},document.onkeypress=t=>{"Space"==t.code&&b<=0?x.useWeapon():"KeyS"==t.code&&D<=0&&(D=7e3,I=2e3)},setInterval((()=>{(0==v||0==k&&0==M.length)&&(()=>{v+=1,l+=.05,p=[],M=[],b=0,I=0,D=0,x=new m(t.width-30,t.height/2),k=0;for(let s=0;s<v+5;s++)p.push(new w(0,t.height/2,!1));for(let t=0;t<v/2;t++)k+=1,p[t].makeSick();o.innerHTML="Poziom: "+v})(),r.innerHTML="Bez maseczki: "+k,s.clearRect(0,0,t.width,t.height),p.forEach((t=>{t.live(x)||M.push(new y(t.coords.x,t.coords.y)),x.weapon&&t.getWeapon(x.weapon)&&(k-=1),t.draw()})),x.live(),x.draw(),x.move(f,I>0),x.weapon&&x.weapon.radius>100&&(x.weapon=null,b=1e3),M.forEach(((t,s,i)=>{t.draw(),p.forEach((s=>{s.getCough(t)&&(k+=1)})),t.radius>100*(1+l)&&i.splice(s,1)})),b=Math.max(b-10,0),D=Math.max(D-10,0),I=Math.max(I-10,0),(()=>{if(I>0){const t=Math.floor(I/2e3*100);a.style.background=`linear-gradient(90deg, #5CB85C ${t}%, #D9534F 0%)`}else{const t=100-Math.floor(D/5e3*100);a.style.background=`linear-gradient(90deg, #5CB85C ${t}%, #D9534F 0%)`}if(b>0){const t=100-Math.floor(b/1e3*100);n.style.background=`linear-gradient(90deg, #5CB85C ${t}%, #D9534F 0%)`}else n.style.background="linear-gradient(90deg, #5CB85C 100%, #D9534F 0%)"})()}),10)})(),t.p})();