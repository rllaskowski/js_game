(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{var s;t.g.importScripts&&(s=t.g.location+"");var i=t.g.document;if(!s&&i&&(i.currentScript&&(s=i.currentScript.src),!s)){var e=i.getElementsByTagName("script");e.length&&(s=e[e.length-1].src)}if(!s)throw new Error("Automatic publicPath is not supported in this browser");s=s.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=s})(),(()=>{const t=document.getElementById("canvas"),s=t.getContext("2d"),i=(t,i,e)=>{s.beginPath(),s.strokeStyle=e,s.lineWidth=3,s.arc(t.x,t.y,i,0,2*Math.PI),s.stroke()},e=(t,i,e)=>{s.drawImage(i,t.x-e.x/2,t.y-e.y/2,e.x,e.y)},r=document.getElementById("sick-text"),o=document.getElementById("level-text"),h=document.getElementById("reset-btn"),a=document.getElementById("speed-bar"),n=document.getElementById("weapon-bar");(new Image).src="./static/img/ethan.png";const c=new Image;c.src="./static/img/cough.png",new Image,c.src="./static/img/cough.png";const d=(t,s)=>(t=Math.ceil(t),s=Math.floor(s),Math.floor(Math.random()*(s-t))+t),u=["Obudzcie się ludzie!","Wirusa nie ma!","Zdejmijcie kagańce!","Co z wami nie tak?!","Propaganda!","To wszystko kłamstwo!"];let l=1.3;class g{constructor(t,s){this.x=t,this.y=s}getDistance(t){const s=this.x-t.x,i=this.y-t.y;return Math.sqrt(s*s+i*i)}getAngle(t,s){return Math.atan2(t.y-this.y,t.x-this.x)-Math.atan2(s.y-this.y,s.x-this.x)}moveInDir(t,s){const i=t.x,e=t.y;if(i!=this.x){const t=Math.abs((e-this.y)/(i-this.x));this.x+=Math.sqrt(s/(t*t+1))*(this.x<i?1:-1),this.y+=t*Math.sqrt(s/(t*t+1))*(this.y<e?1:-1)}else this.y+=s*(this.y<e?1:-1)}}class w{constructor(t,s){this.radius=0,this.coords=new g(t,s)}draw(){i(this.coords,this.radius,"#4CAF50"),this.radius+=2}}class m{constructor(t,s){this.velocity=.9,this.radius=20,this.coords=new g(t,s),this.weapon=null}draw(){var t,i;t=this.coords,i=this.radius,s.beginPath(),s.arc(t.x,t.y,i,0,2*Math.PI),s.fillStyle="#000000",s.fill(),s.closePath(),this.weapon&&this.weapon.draw()}live(){}move(s,i){this.coords.getDistance(s)<1||(this.coords.moveInDir(s,this.velocity*i?2:1),this.coords.x+this.radius>t.width?this.coords.x=t.width-this.radius:this.coords.x-this.radius<0&&(this.coords.x=this.radius),this.coords.y+this.radius>t.height?this.coords.y=t.height-this.radius:this.coords.y-this.radius<0&&(this.coords.y=this.radius))}getBonus(t){return this.coords.getDistance(t.coords)<this.radius+t.radius}useWeapon(){null===this.weapon&&(this.weapon=new w(this.coords.x,this.coords.y))}}class y{constructor(){this.radius=30;const s=d(this.radius,t.width-this.radius),i=d(this.radius,t.height-this.radius);this.coords=new g(s,i)}draw(){e(this.coords,sanatizer,new g(2*this.radius,2*this.radius))}}class p{constructor(t,s,i){this.radius=30,this.velocity=1,this.coords=new g(t,s),this.dest=new g(t,s),this.sick=i}draw(){this.sick?e(this.coords,cough,new g(2*this.radius,2*this.radius)):e(this.coords,ethan,new g(2*this.radius,2*this.radius))}makeSick(){return!this.sick&&(this.sick=!0,this.velocity=l,this.lifetime=d(800,1e3),!0)}changeDest(s){if(this.coords.getDistance(this.dest)<3&&(this.dest=new g(d(this.radius,t.width-this.radius),d(this.radius,t.height-this.radius)),this.sick)){let i=this.coords.getAngle(s.coords,this.dest),e=this.coords.getDistance(this.dest);for(;Math.abs(i)<.7&&e>130;)this.dest=new g(d(this.radius,t.width-this.radius),d(this.radius,t.height-this.radius)),i=this.coords.getAngle(s.coords,this.dest)}}move(){this.coords.moveInDir(this.dest,this.velocity)}makeHealthy(){return!!this.sick&&(this.sick=!1,this.radius=30,!0)}getWeapon(t){return!!(this.coords.getDistance(t.coords)<this.radius+t.radius&&this.makeHealthy())}getCough(t){return!!(this.coords.getDistance(t.coords)<Math.max(this.radius,t.radius)&&this.makeSick())}live(t){if(this.sick&&(this.lifetime-=1,this.lifetime<=100)){if(this.lifetime<=0)return this.lifetime=d(800,1e3),this.radius=30,this.velocity=l,!1;this.radius+=.1}return this.changeDest(t),this.move(),!0}}class x{constructor(t,s){this.radius=0,this.coords=new g(t,s),this.text=u[d(0,u.length)]}draw(){var t,e;i(this.coords,this.radius,"#FF0000"),t=this.coords,e=this.text,s.font="400 17px Arial",s.fillText(e,t.x,t.y),this.radius+=2}}let f,k,v,M,b,D=new g(100,100),I=0,B=0,C=[],E=0,S=0,z=0;h.onclick=()=>{B=0,document.activeElement.blur()},document.onmousemove=s=>{D=((t,s)=>{const i=t.getBoundingClientRect();return new g(s.clientX-i.left,s.clientY-i.top)})(t,s)},document.onkeypress=t=>{"Space"==t.code&&E<=0?k.useWeapon():"KeyS"==t.code&&S<=0&&(S=7e3,z=2e3)},setInterval((()=>{(0==B||0==I&&0==C.length)&&(()=>{B+=1,l+=.05,f=[],C=[],M=null,v=d(8e3,1e4),E=0,z=0,S=0,k=new m(t.width-30,t.height/2),I=0,b=!1;for(let s=0;s<B+5;s++)f.push(new p(0,t.height/2,!1));for(let t=0;t<B/2;t++)I+=1,f[t].makeSick();o.innerHTML="Poziom "+B})(),r.innerHTML="Bez maseczki: "+I,s.clearRect(0,0,t.width,t.height),M?k.getBonus(M)?(M=null,v=d(8e3,1e4),b=!0):M.draw():v<=0&&(M=new y),f.forEach((t=>{t.live(k)||C.push(new x(t.coords.x,t.coords.y)),k.weapon&&t.getWeapon(k.weapon)&&(I-=1),t.draw()})),k.live(),k.draw(),k.move(D,z>0),k.weapon&&k.weapon.radius>100*(b?2:1)&&(k.weapon=null,b=!1,E=1e3),C.forEach(((t,s,i)=>{t.draw(),f.forEach((s=>{s.getCough(t)&&(I+=1)})),t.radius>100*l&&i.splice(s,1)})),E=Math.max(E-10,0),S=Math.max(S-10,0),z=Math.max(z-10,0),b||(v=Math.max(v-10,0)),(()=>{if(z>0){const t=Math.floor(z/2e3*100);a.style.background=`linear-gradient(90deg, #5CB85C ${t}%, #D9534F 0%)`}else{const t=100-Math.floor(S/5e3*100);a.style.background=`linear-gradient(90deg, #5CB85C ${t}%, #D9534F 0%)`}if(E>0){const t=100-Math.floor(E/1e3*100);n.style.background=`linear-gradient(90deg, #5CB85C ${t}%, #D9534F 0%)`}else n.style.background="linear-gradient(90deg, #5CB85C 100%, #D9534F 0%)"})()}),10)})(),t.p})();